<html>
 	<meta charset="UTF-8">
	<style>
		html {
			font-family: "Optima", serif;
			--title-space: 4mm;
			--paragraph-space: 2mm;
		}
		
		html, body {
			margin: 0;
			padding: 0;
			hanging-punctuation: allow-end;
		}
		
		@page {
  		margin: 0;
			padding: 0;
		}
		
		@media screen {
			section {
				margin-top: 2mm;
				box-shadow: 0 0px 10px gray;
			}
		}
		
		@media print {
			div.controls {
				display: none;
			}
		}
		
		section {
			width: 128mm;
/*		4 * page height - (padding top&bottom)	*/
			height: calc(4 * 210mm - 21mm);
			padding: 10mm;
			overflow: hidden;
			position: relative;
		}
		
		h1, h2, h3 {
			font-family: "Palatino", serif;
			margin-top: var(--title-space);
			margin-bottom: var(--paragraph-space);
		}		
		h2, h3 {
			font-size: 5mm;
			font-variant: small-caps
		}
		h1 {
			font-size: 6mm;
			margin-top: 0;
		}

		.center { text-align: center }
		.right p { text-align-last: right }
		.italicÂ {
			font-style: italic
		}
		
		p, li, td {
			font-size: 3.6mm;
			line-height: 1.2;
		}

		p {
			text-align: justify;
		}
		
		.splitted {
			display: block;
			text-align-last: justify;
		}
		
		.two-columns {
			column-count: 2;
		}
				
		ol {
			list-style: none;
			counter-reset: li;
			--indentation: 5mm;
			padding-left: var(--indentation);
			margin-top: var(--paragraph-space);
		}
		
		ol li::before, ol .counter {
  		display: block;
			float: left;
			width: var(--indentation);
  		margin-left: calc(0em - var(--indentation));
		}
		
		ol.auto-count li::before {
			content: counter(li)".";
		}
		
		li {
			counter-increment: li;
			break-inside: avoid-column;
			margin-right: calc(var(--indentation)/2);
			padding-bottom: var(--paragraph-space)
		}
		
		p {
			margin-top: var(--paragraph-space);
			margin-bottom: var(--paragraph-space);
		}
		
		.flex.title {
			margin-top: var(--title-space);
		}
		
		.flex {
			display: flex;
			justify-content: space-between;
		}
		
		.flex div, td {
			padding: 0 2mm;
			align-self: baseline;
		}
		.flex div:first-of-type, td:first-of-type {
			padding-left: 0
		}
		.flex div:last-of-type, td:last-of-type {
			padding-right: 0
		}
		
		.flex h3 {
			margin: 0;
		}
		
		.flex .equal { flex: 1 }
		
		.comment {
			font-size: 3mm;
			color: gray;
		}
		
		.response {
			font-weight: bold;
			position: relative;
		}
		
		.response::before {
			content: 'R. ';
			color: gray;
		}
						
		div.controls {
			position: absolute;
			left: 155mm;
		}
		
		.psalm p {
			text-align: left;
			text-align-last: left;
		}
		
		section div.page-indicators {
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			background: #F0F0F0;
			z-index: -2;
			opacity: 0.2;
/*			display: none;*/
		}
		
		section div.page-indicators div {
			margin-top: calc(210mm - 1px);
			height: 1px;
			background: red;
		}
		
		section div.page-indicators div::before {
			transform: translate(0, -10mm);
			height: 20mm;
			background: #BBB;
			content: ' ';
			display: block;
			position: relative;
			z-index: -1;
		}
		
		.avoid-pagebreak {
			background: rgba(255, 255, 0, 0.2);
		}
		
		table {
			border-spacing: 0;
			margin-top: var(--paragraph-space)
		}
	</style>
	<script>
		let section;
		window.addEventListener('load', setSection)
		
		function insertAutoPageBreaks() {
			for (let page = 0; page < 3; page++) {
				insertAutoPageBreak(page)
			}
		}
		
		function insertAutoPageBreak(page) {
			const mm = getPixelsPerMillimeter()
			const marge = (210 * (page+1) - 10) * mm
			
			const manualPageBreak = document.querySelector('.prefer-pagebreak')
			console.log(manualPageBreak, manualPageBreak ? sectionOffset(manualPageBreak) : undefined, marge)
			if (manualPageBreak && sectionOffset(manualPageBreak) < marge) {
				insertPageBreakBefore(manualPageBreak, marge, mm)
				manualPageBreak.parentNode.removeChild(manualPageBreak)
			} else {
				for (const block of findOverflowNodes(marge)) {
					if (block.nodeType === Node.TEXT_NODE) {
						const textNode = splitText(block, marge)
						insertPageBreakBefore(textNode, marge, mm)
					} else {
						insertPageBreakBefore(block, marge, mm)
					}
				}
			}
		}
		
		function splitText(node, marge) {
			const range = document.createRange()
			const secondHalf = node.splitText(
				binarySearch(node.nodeValue.length, liesBeforeMarge)
			)
			const span = document.createElement('span')
			node.parentNode.replaceChild(span, node)
			span.appendChild(node)
			span.className = 'splitted'
			return secondHalf
			
			function liesBeforeMarge(letterIndex) {
				range.setStart(node, letterIndex)
				range.setEnd(node, letterIndex+1)
				return sectionOffset(range, true) > marge
			}
		}
		
		/*
		 * Return i such that !pred(i - 1) && pred(i) && 0 <= i <= length.
		 */
		function binarySearch(length, pred) {
			let lo = -1, hi = length;
			while (1 + lo < hi) {
				const mi = lo + ((hi - lo) >> 1);
				if (pred(mi)) hi = mi;
				else lo = mi;
			}
			return hi;
		}
		
		function insertPageBreakBefore(block, marge, mm) {
			const space = document.createElement('div')
			block.parentNode.insertBefore(space, block)
			const offsetTop = sectionOffset(space, false)
			const correction = (marge - offsetTop)/mm
			space.style.height = (20 + correction) + 'mm'
		}
		
		function findOverflowNodes(marge) {
			return smallestPartOf(
				document.querySelectorAll('section > *:not(.page-indicators)').values()
			)
			
			function smallestPartOf(blocks) {
				for (const block of blocks) {
					if (sectionOffset(block, true) > marge) {
						if (isFlex(block)) {
							return Array
								.from(block.children)
								.flatMap( column => smallestPartOf([column]) )
						} else {
							if (shouldSplit(block)) {
								return smallestPartOf(block.childNodes)
							} else {
								return [block]
							}
						}
					}
				}
			}
			
			function shouldSplit(block) {
				return mayPageBreak(block) && block.hasChildNodes()
			}
		}
		
		function mayPageBreak(block) {
			if (block.classList && (block.classList.contains('avoid-pagebreak') || block.classList.contains('two-columns')))
				return false
			return true
		}
		
		function isFlex(block) {
			return block.classList && block.classList.contains('flex')
		}
						
		function getPixelsPerMillimeter() {
			return section.clientWidth / 148
		}
				
		function setSection() {
			section = document.querySelector('section')
		}
		
		function sectionOffset(element, includeHeight) {
			if (element.nodeType === Node.TEXT_NODE) {
				const range = document.createRange()
				range.selectNode(element)
				element = range
			}
			const sectionY = section.getBoundingClientRect().y
			const elementRect = element.getBoundingClientRect()
			return (includeHeight===true ? elementRect.bottom : elementRect.y) - sectionY;
		}

		function textNodesUnder(el){
			var n, a=[], walk=document.createTreeWalker(el,NodeFilter.SHOW_TEXT,null,false);
			while(n=walk.nextNode()) a.push(n);
			return a;
		}
	</script>
	<body>
		<div class="controls">
			<button onclick="insertAutoPageBreaks()">Insert page break margins</button>
		</div>
		<section>
			<div class="page-indicators">
				<div></div>
				<div></div>
				<div></div>
				<div></div>
			</div>

			<h1 class="center">Supplementary sheet - Bijgevoegd blad</h1>
			<h2 class="center">24 Oktober 2019</h2>
		
			<h3>Openingslied - Entrance Hymn</h3>
			<ol class="two-columns">
				<li>
					<span class="counter">1.</span>
					Juicht voor de Heer, alle landen,<br>
					Dient met blijdschap de Heer,<br>
					Treedt onbezorgd voor zijn aanschijn.<br>
					Waarlijk, de Heer is God.<br>
				</li>
				<li>
					<span class="counter">R.</span>
					<b>Alleluia, alleluia <br>
					Alleluia, alleluia!</b>
				</li>
				<li>
					<span class="counter">2.</span>
					Juicht voor de Heer, alle landen,<br>
					Dient met blijdschap de Heer,<br>
					Treedt onbezorgd voor zijn aanschijn.<br>
					Waarlijk, de Heer is God.<br>
				</li>
				<li>
					<span class="counter">3.</span>
					Juicht voor de Heer, alle landen,<br>
					Dient met blijdschap de Heer,<br>
					Treedt onbezorgd voor zijn aanschijn.<br>
					Waarlijk, de Heer is God.<br>
				</li>
			</ol>
			
			<div class="avoid-pagebreak">
				<div class="flex title">
					<div><h1>Dienst van het woord</h1></div>
					<div><h1>Liturgy of the Word</h1></div>
				</div>
				<div class="flex">
					<div><h3>Eerste lezing</h3></div>
					<div><span class="comment">Rom. 6, 19-23</span></div>
					<div><h3>First reading</h3></div>
				</div>
			</div>
			<div class="flex">
				<div class="equal">
					<p>
						Uit de brief van de heilige apostel Paulus aan de christenen van Rome.
					</p>
					<p>
						Broeders en zusters, sprekend tot zwakke mensen druk ik mij erg menselijk uit. Zoals gij eertijds uw ledematen in dienst hebt gesteld van onreinheid en steeds grotere bandeloosheid, zo moet gij ze nu in dienst stellen van de gerechtigheid tot uw heiliging. Toen gij slaven waart van de zonde, stond gij vrij ten opzichte van de gerechtigheid. Welk voordeel had gij toen van daden waarover gij u thans schaamt? Want het einde daarvan is de dood. Maar nu, bevrijd van de zonde en dienstknechten geworden van God, oogst gij heiligheid en tenslotte eeuwig leven. Want het loon van de zonde is de dood, maar de gave van God is het eeuwige leven in Christus Jezus, onze Heer.
					</p>
					<p class="avoid-pagebreak">
						Zo spreekt de Heer.<br>
						<b>Wij danken God.</b>
					</p>
				</div>
				<div class="equal right">
					<p>From a letter of the apostle Paul to the Romans.</p>
					<p>Brothers and sisters: I am speaking in human terms because of the weakness of your nature. For just as you present- ed the parts of your bodies as slaves to impurity and to lawlessness for lawless- ness, so now present them as slaves to righteousness for sanctification. For when you were slaves of sin, you were free from righteousness. But what profit did you get then from the things of which you are now ashamed? For the end of those things is death. But now that you have been freed from sin and have be- come slaves of God, the benefit that you have leads to sanctification, and its end is eternal life. For the wages of sin is death, but the gift of God is eternal life in Christ Jesus our Lord.</p>
					<p class="avoid-pagebreak">
						The Word of the Lord.<br>
						<b>Thanks be to God. </b>
					</p>
				</div>
			</div>
			<h3>Psalm</h3>
			<div class="flex psalm">
				<div class="equal">
					<p class="response">
						Gelukkig is de man die op de Heer zijn hoop stelt.
					</p>
					<p>
						Gelukkig de man die weigert te doen,
						wat goddelozen hem raden;
						die niet de wegen der zondaars gaat,
						niet zit te midden der spotters;
						maar die zijn geluk vindt in âs Heren wet, haar dag en nacht overweegt.
					</p>
					<p>
						Hij is als een boom, aan het water geplant,
						die vruchten draagt op zijn tijd;
						des zomers verdorren zijn bladeren niet,
						maar al wat hij doet brengt hem voorspoed. 
					</p>
					<p>
						De goddelozen vergaat het zo niet: de wind blaast hen weg als kaf. De Heer immers let op de weg der gerechten, de weg van de zondaars loopt dood.
					</p>
				</div>
				<div class="equal right">
					<p class="response">Blessed are they who hope in the Lord.
					</p>
					<p>
						Blessed the man who follows not the counsel of the wicked Nor walks in the way of sinners, nor sits in the company of the insolent, But delights in the law of the LORD and meditates on his law day and night.
					</p>
					<p>
						He is like a tree planted near running water, That yields its fruit in due sea- son, and whose leaves never fade. Whatever he does, prospers.<br><br>
					</p>
					<p>
						Not so the wicked, not so; they are like chaff which the wind drives away. For the LORD watches over the way of the just, but the way of the wicked vanishes.
					</p>
				</div>
			</div>
			<div class="prefer-pagebreak"></div>
			
			<div class="avoid-pagebreak">
				<div class="flex title">
					<div><h3>Alleluia</h3></div>
					<div><span class="comment">Ps. 119/118, 88</span></div>
				</div>
				<span class="comment">Rechtstaan a.u.b. - Please stand</span>
				<div class="flex">
					<div><p>Wees mij barmhartig en laat mij leven, Heer, dan blijf ik aan wat Gij verordent trouw.</p></div>
					<div class="right"><p>I consider all things so much rubbish that I may gain Christ and be found in him.</p></div>
				</div>
			</div>
			
			<div class="avoid-pagebreak">
				<div class="flex title">
					<div><h3>Evangelie - Gospel</h3></div>
					<div><span class="comment">Lc. 12, 49-53</span></div>
				</div>
				<table>
					<tr>
						<td>De Heer zij met u.</td>
						<td><span class="comment">of</span></td>
						<td>De Heer zal bij u zijn.</td>
					</tr>
					<tr>
						<td><b>En met uw geest.</b></td>
						<td><span class="comment">of</span></td>
						<td><b>De Heer zal u bewaren.</b></td>
					</tr>
				</table>

				<p>
					Uit het heilig evangelie van onze Heer Jezus Christus volgens Lucas.<br>
					<b>Lof zij U, Christus.</b>
				</p>
			</div>
			<div class="flex">
				<div class="equal">
					<p>
						In die tijd zei Jezus tot zijn leerlingen: âVuur ben Ik op aarde komen brengen, en hoe verlang Ik dat het reeds oplaait! Ik moet een doopsel ondergaan, en hoe beklemd voel Ik Mij, totdat het volbracht is. Meent gij dat Ik op aarde vrede ben komen brengen? Neen, zeg Ik u, juist verdeeldheid. Want van nu af zullen er vijf in Ã©Ã©n huis verdeeld zijn; drie zullen er staan tegenover twee en twee tegenover drie; de vader tegenover de zoon en de zoon tegenover de vader; de moeder tegenover de dochter en de dochter tegenover de moeder, de schoonmoeder tegenover haar schoondochter en de schoondochter tegenover de schoonmoeder.â
					</p>
					<div class="avoid-pagebreak">
						<p>
							Tot zover het Evangelie.<br>
							<b>Wij danken God.</b>
						</p>
						<p class="comment">
							Zitten a.u.b. De Mis gaat verder in boekje p3
						</p>
					</div>
				</div>
				<div class="equal right">
					<p>Jesus said to his disciples: âI have come to set the earth on fire, and how I wish it were already blazing! There is a baptism with which I must be baptized, and how great is my anguish until it is accomplished! Do you think that I have come to establish peace on the earth? No, I tell you, but rather division. From now on a household of five will be divided, three against two and two against three; a father will be divided against his son and a son against his father, a mother against her daughter and a daughter against her mother, a mother-in-law against her daughter-in- law and a daughter-in-law against her mother-in-law.â</p>
					<div class="avoid-pagebreak">
						<p>
							The Gospel of the Lord.<br>
							<b>Thanks be to God. </b>
						</p>
						<p class="comment">
							Please sit. The Mass continues in booklet p3
						</p>
					</div>
				</div>
			</div>
			
			<div class="prefer-pagebreak"></div>
			
			<h3>Offerande - Offertory Hymn</h3>
			<ol class="auto-count">
				<li>
					As we stand before the table<br>
					where Christ offers Himself in our midst.<br> 
					All we are we offer with Him as He changes our being to His own.
				</li>
				<li>
					Welk een ruil waarin wij delen: <br>
					Christus neemt onze zondigheid aan, <br>
					geeft zichzelf als brood voor velen, <br>
					deelt met ons zijn goddelijk bestaan.
				</li>
				<li>
					Glory Father to the love which sent your Son Jesus Christ to our world. <br>
					By the power of Your Spirit, <br>
					purify us bring Your life to all.
				</li>
			</ol>
			
			<h3>Communielied - Communion Hymn</h3>
			<ol>
				<li class="avoid-pagebreak">
					<span class="counter">R.</span>
					Ik verhef U, mijn Koning en God. <br>
					Heer, ik zegen voor eeuwig uw Naam. <br>
					Mijn hart wil U prijzen dag aan dag. <br>
					Ik loof uw Naam voor eeuwig en altijd! <br>
				</li>
				<li class="avoid-pagebreak">
					<span class="counter">1.</span>
					Barmhartig en genadig is de Heer. <br>
					Hij is vol liefde voor al wat bestaat. <br>
					De Heer toont zijn goedheid aan ons, <br>
					Zijn erbarming aan al wat er leeft. <br>
				</li>
				<li class="avoid-pagebreak">
					<span class="counter">R.</span>
					I exalt You God my King,<br>
					I will bless your name ever more,<br>
					My heart and my soul sing your praise, <br>
					Tell the world the glory of your name. <br>
				</li>
				<li class="avoid-pagebreak">
					<span class="counter">2.</span>
					Praise the Lord, creation praise the Lord, <br>
					May your people always bless your name, <br>
					Praise the Lord give glory to your reign, <br>
					May your wonders be praised here on earth. <br>
				</li>
				<li class="avoid-pagebreak">
					<span class="counter">3.</span>
					Rechtvaardig is de Heer in wat Hij doet. <br>
					Hij is nabij voor de mens die Hem roept. <br>
					Hij steunt al wie struikelt en valt.<br>
					De gebogenen richt Hij weer op.<br>
				</li>
			</ol>
			
		</section>
	</body>
</html>